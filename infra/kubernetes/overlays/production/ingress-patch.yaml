apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: dolesewonderlandfx-api
  annotations:
    kubernetes.io/ingress.class: "nginx"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "50m"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "300"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "300"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
spec:
  tls:
  - hosts:
    - api.dolesewonderlandfx.com
    - app.dolesewonderlandfx.com
    - admin.dolesewonderlandfx.com
    - instructor.dolesewonderlandfx.com
    - dolesewonderlandfx.com
    - auth.dolesewonderlandfx.com
    - ai.dolesewonderlandfx.com
    - insights.dolesewonderlandfx.com
    - backtester.dolesewonderlandfx.com
    - paper.dolesewonderlandfx.com
    - email.dolesewonderlandfx.com
    - social.dolesewonderlandfx.com
    - monitoring.dolesewonderlandfx.com
    secretName: dolesewonderlandfx-tls
  rules:
  # Frontend Applications
  - host: app.dolesewonderlandfx.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: dolesewonderlandfx-app-frontend
            port:
              number: 3000
  - host: admin.dolesewonderlandfx.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: dolesewonderlandfx-admin-panel
            port:
              number: 3000
  - host: instructor.dolesewonderlandfx.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: dolesewonderlandfx-instructor-portal
            port:
              number: 3000
  - host: dolesewonderlandfx.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: dolesewonderlandfx-web-landing
            port:
              number: 3000
  # Backend API Services
  - host: api.dolesewonderlandfx.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: dolesewonderlandfx-api
            port:
              number: 8000
  - host: backtester.dolesewonderlandfx.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: dolesewonderlandfx-backtester
            port:
              number: 8001
  - host: auth.dolesewonderlandfx.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: dolesewonderlandfx-auth
            port:
              number: 8002
  - host: ai.dolesewonderlandfx.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: dolesewonderlandfx-ai-pipeline
            port:
              number: 8003
  - host: insights.dolesewonderlandfx.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: dolesewonderlandfx-insight-generator
            port:
              number: 8004
  - host: paper.dolesewonderlandfx.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: dolesewonderlandfx-paper-trading
            port:
              number: 8005
  - host: email.dolesewonderlandfx.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: dolesewonderlandfx-email
            port:
              number: 8006
  - host: social.dolesewonderlandfx.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: dolesewonderlandfx-social-trading
            port:
              number: 8007
  - host: monitoring.dolesewonderlandfx.com
    http:
      paths:
      - path: /prometheus
        pathType: Prefix
        backend:
          service:
            name: dolesewonderlandfx-prometheus
            port:
              number: 9090
      - path: /grafana
        pathType: Prefix
        backend:
          service:
            name: dolesewonderlandfx-grafana
            port:
              number: 3000